@if (!$content)
    <div class="tours section-padding">
        <div class=container>
            <div class=tours-content>
                <div class=section-content>
                    <div class=heading>Top Tours</div>
                </div>
                <div class="d-flex justify-content-end">
                    <a href=# class="primary-btn" style="background: transparent;color: var(--color-primary);">More<i
                            class="bx bx-right-arrow-alt"></i></a>
                </div>
            </div>
            <div class="row pt-3">
                <div class="col">
                    <div class=card-content>
                        <a href=# class=card_img>
                            <img data-src={{ asset('assets/images/alanya-tandem-paragliding-tour.webp') }} alt=image
                                class="imgFluid lazy" loading="lazy">
                            <div class=price-details>
                                <div class=price>
                                    <span>
                                        <b>€30</b>
                                        From
                                    </span>
                                </div>
                                <div class=heart-icon>
                                    <div class=service-wishlis>
                                        <i class="bx bx-heart"></i>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <div class=card-details>
                            <a href=# class=card-title>Mezze Grill Restaurant</a>
                            <div class=location-details><i class="bx bx-location-plus"></i>Alanya<span> $ - $$</span>
                            </div>
                            <div class=card-rating>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star"></i>
                                <span>10 Reviews</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class=card-content>
                        <a href=# class=card_img>
                            <img data-src={{ asset('assets/images/rafting.webp') }} alt=image class="imgFluid lazy"
                                loading="lazy">
                            <div class=price-details>
                                <div class=price>
                                    <span>
                                        <b>€30</b>
                                        From
                                    </span>
                                </div>
                                <div class=heart-icon>
                                    <div class=service-wishlis>
                                        <i class="bx bx-heart"></i>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <div class=card-details>
                            <a href=# class=card-title>Mezze Grill Restaurant</a>
                            <div class=location-details><i class="bx bx-location-plus"></i>Alanya<span> $ - $$</span>
                            </div>
                            <div class=card-rating>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star"></i>
                                <span>10 Reviews</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class=card-content>
                        <a href=# class=card_img>
                            <img data-src={{ asset('assets/images/quad.webp') }} alt=image class="imgFluid lazy"
                                loading="lazy">
                            <div class=price-details>
                                <div class=price>
                                    <span>
                                        <b>€30</b>
                                        From
                                    </span>
                                </div>
                                <div class=heart-icon>
                                    <div class=service-wishlis>
                                        <i class="bx bx-heart"></i>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <div class=card-details>
                            <a href=# class=card-title>Mezze Grill Restaurant</a>
                            <div class=location-details><i class="bx bx-location-plus"></i>Alanya<span> $ - $$</span>
                            </div>
                            <div class=card-rating>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star"></i>
                                <span>10 Reviews</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class=card-content>
                        <a href=# class=card_img>
                            <img data-src={{ asset('assets/images/buggy.webp') }} alt=image class="imgFluid lazy"
                                loading="lazy">
                            <div class=price-details>
                                <div class=price>
                                    <span>
                                        <b>€30</b>
                                        From
                                    </span>
                                </div>
                                <div class=heart-icon>
                                    <div class=service-wishlis>
                                        <i class="bx bx-heart"></i>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <div class=card-details>
                            <a href=# class=card-title>Mezze Grill Restaurant</a>
                            <div class=location-details><i class="bx bx-location-plus"></i>Alanya<span> $ - $$</span>
                            </div>
                            <div class=card-rating>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star"></i>
                                <span>10 Reviews</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class=card-content>
                        <a href=# class=card_img>
                            <img data-src={{ asset('assets/images/jeep.webp') }} alt=image class="imgFluid lazy"
                                loading="lazy">
                            <div class=price-details>
                                <div class=price>
                                    <span>
                                        <b>€30</b>
                                        From
                                    </span>
                                </div>
                                <div class=heart-icon>
                                    <div class=service-wishlis>
                                        <i class="bx bx-heart"></i>
                                    </div>
                                </div>
                            </div>
                        </a>
                        <div class=card-details>
                            <a href=# class=card-title>Mezze Grill Restaurant</a>
                            <div class=location-details><i class="bx bx-location-plus"></i>Alanya<span> $ - $$</span>
                            </div>
                            <div class=card-rating>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star yellow-star"></i>
                                <i class="bx bxs-star"></i>
                                <span>10 Reviews</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
@else
    @php
        $backgroundColor = null;
        if ($content->box_type === 'normal_with_background_color') {
            $backgroundColor = isset($content->normal_background_color) ? $content->normal_background_color : null;
        } elseif ($content->box_type === 'slider_carousel_with_background_color') {
            $backgroundColor = isset($content->slider_carousel_background_color)
                ? $content->slider_carousel_background_color
                : null;
        }
        $toursQuery = \App\Models\Tour::query();

        // Order conditions (as per your original code)
        if ($content->order_by === 'latest') {
            $toursQuery->orderBy('created_at', 'desc');
        } elseif ($content->order_by === 'title') {
            $toursQuery->orderBy('title', 'asc');
        } elseif ($content->order_by === 'price_low_to_high') {
            $toursQuery->orderBy('regular_price', 'asc');
        } elseif ($content->order_by === 'price_high_to_low') {
            $toursQuery->orderBy('regular_price', 'desc');
        }
        if (isset($content->show_only_featured_items)) {
            $toursQuery->where('is_featured', '1');
        }

        // Additional conditions like 'custom' filters or categories
        if ($content->filter_type === 'custom') {
            $toursQuery->whereIn('id', $content->custom_tour_ids);
        } else {
            if (isset($content->filter_category_id)) {
                $toursQuery->where('category_id', $content->filter_category_id);
            }
            if (isset($content->filter_city_id)) {
                $cityIds = (array) $content->filter_city_id;
                $toursQuery->whereHas('cities', function ($query) use ($cityIds) {
                    $query->whereIn('cities.id', $cityIds);
                });
            }
        }

        // Limit the number of tours if applicable
        $toursLimit = $content->no_of_items;
        $tours = $toursQuery->limit($toursLimit)->get();
    @endphp
    <div class="section-padding" style="background-color: {{ $backgroundColor ?? 'transparent' }}">
        <div class=container>
            <div class=tours-content>
                <div class="row w-100 align-items-center">
                    <div class="col-md-9 mb-4">
                        <div class=section-content>
                            <div class=heading>{{ $content->title }}</div>
                            <div class=desc>{{ $content->description }}</div>
                        </div>
                    </div>
                    @if (isset($content->is_more_btn_enabled))
                        <div class="col-md-3">
                            <div class="d-flex justify-content-end">
                                <a href=# class="primary-btn"
                                    style="background: {{ $content->see_more_background_color ?? 'transparent' }};color: {{ $content->see_more_text_color ?? 'var(--color-primary)' }};">{{ $content->see_more_text }}<i
                                        class="bx bx-right-arrow-alt"></i></a>
                            </div>
                        </div>
                    @endif
                </div>
            </div>
            <div
                class="row {{ in_array($content->box_type, ['slider_carousel', 'slider_carousel_with_background_color']) ? 'five-items-slider' : 'row-cols-1 row-cols-md-3 row-cols-lg-3 row-cols-xl-5' }}">
                @foreach ($tours as $tour)
                    <div class="col">
                        <div class=card-content>
                            <a href=# class=card_img>
                                <img data-src={{ asset($tour->featured_image ?? 'admin/assets/images/placeholder.png') }}
                                    alt="{{ $tour->featured_image_alt_text ?? 'image' }}" class="imgFluid lazy"
                                    loading="lazy">
                                <div class=price-details>
                                    <div class=price>
                                        <span>
                                            <b>{{ formatPrice($tour->regular_price) }}</b>
                                            From
                                        </span>
                                    </div>
                                    <div class=heart-icon>
                                        <div class=service-wishlis>
                                            <i class="bx bx-heart"></i>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <div class=card-details>
                                <a href=# data-bs-toggle="tooltip" class=card-title
                                    title="{{ $tour->title }}">{{ $tour->title }}</a>
                                @if ($tour->cities->isNotEmpty())
                                    <div data-bs-toggle="tooltip"
                                        title="{{ $tour->cities->pluck('name')->implode(', ') }}"
                                        class=location-details><i class="bx bx-location-plus"></i>
                                        {{ $tour->cities[0]->name }}
                                    </div>
                                @endif
                                <div class=card-rating>
                                    <i class="bx bxs-star yellow-star"></i>
                                    <i class="bx bxs-star yellow-star"></i>
                                    <i class="bx bxs-star yellow-star"></i>
                                    <i class="bx bxs-star yellow-star"></i>
                                    <i class="bx bxs-star"></i>
                                    <span>10 Reviews</span>
                                </div>
                            </div>
                        </div>
                    </div>
                @endforeach
            </div>
        </div>
    </div>
@endif
